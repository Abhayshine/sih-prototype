<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeTour v2.0 - Advanced Tourist Safety Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .emergency-pulse {
            animation: emergencyPulse 1s infinite;
        }
        @keyframes emergencyPulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 0 0 0 20px rgba(239, 68, 68, 0);
            }
        }
        .sos-button {
            background: linear-gradient(45deg, #dc2626, #ef4444);
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.4);
            transition: all 0.3s ease;
        }
        .sos-button:hover {
            background: linear-gradient(45deg, #b91c1c, #dc2626);
            box-shadow: 0 6px 20px rgba(220, 38, 38, 0.6);
            transform: translateY(-2px);
        }
        .sos-active {
            animation: sosActive 0.5s infinite alternate;
        }
        @keyframes sosActive {
            0% { background: #dc2626; }
            100% { background: #7f1d1d; }
        }
        .emergency-overlay {
            background: rgba(220, 38, 38, 0.95);
            backdrop-filter: blur(10px);
        }
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .status-safe { background: #10b981; }
        .status-caution { background: #f59e0b; }
        .status-danger { background: #ef4444; }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .notification {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        .loading {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .emergency-countdown {
            font-size: 3rem;
            font-weight: bold;
            color: #dc2626;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .page {
            display: none;
        }
        .page.active {
            display: block;
        }
        .nav-link {
            transition: color 0.3s ease;
        }
        .nav-link:hover {
            color: #667eea;
        }
        .nav-link.active {
            color: #667eea;
            border-bottom: 2px solid #667eea;
        }
        .qr-info-card {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px solid #0ea5e9;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Emergency SOS Modal -->
    <div id="sosModal" class="modal">
        <div class="emergency-overlay w-full h-full flex items-center justify-center">
            <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-md w-full mx-4 text-center">
                <div class="mb-6">
                    <i class="fas fa-exclamation-triangle text-6xl text-red-600 mb-4 emergency-pulse"></i>
                    <h2 class="text-3xl font-bold text-red-600 mb-2">EMERGENCY SOS</h2>
                    <p class="text-gray-700">Emergency alert will be sent in:</p>
                </div>
                
                <div class="mb-6">
                    <div id="sosCountdown" class="emergency-countdown">5</div>
                    <p class="text-sm text-gray-600">seconds</p>
                </div>
                
                <div class="space-y-3 mb-6">
                    <button onclick="cancelSOS()" class="w-full bg-gray-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-gray-700 transition duration-300">
                        Cancel Emergency
                    </button>
                    <button onclick="sendSOSNow()" class="w-full bg-red-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-red-700 transition duration-300">
                        Send SOS Now
                    </button>
                </div>
                
                <div class="text-xs text-gray-500">
                    <p>Your location and emergency details will be sent to:</p>
                    <p>• Local Police • Emergency Contacts • Tourism Department</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Emergency Response Modal -->
    <div id="emergencyResponseModal" class="modal">
        <div class="bg-red-600 text-white p-8 rounded-2xl shadow-2xl max-w-lg w-full mx-4">
            <div class="text-center">
                <i class="fas fa-ambulance text-6xl mb-4 emergency-pulse"></i>
                <h2 class="text-3xl font-bold mb-4">EMERGENCY ACTIVATED</h2>
                <div class="bg-red-700 p-4 rounded-lg mb-6">
                    <p class="text-lg font-semibold mb-2">Emergency ID: <span id="emergencyId" class="font-mono"></span></p>
                    <p class="text-sm">Response units have been dispatched</p>
                </div>
                
                <div class="space-y-3 text-left bg-red-700 p-4 rounded-lg mb-6">
                    <div class="flex items-center">
                        <i class="fas fa-check mr-3"></i>
                        <span>Police notified - ETA: 3-5 minutes</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-check mr-3"></i>
                        <span>Emergency contacts alerted</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-check mr-3"></i>
                        <span>Medical assistance dispatched</span>
                    </div>
                    <div class="flex items-center">
                        <i class="fas fa-check mr-3"></i>
                        <span>Tourism department informed</span>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-3">
                    <button onclick="callEmergencyHotline()" class="bg-white text-red-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition duration-300">
                        <i class="fas fa-phone mr-2"></i>Call 911
                    </button>
                    <button onclick="shareEmergencyLocation()" class="bg-yellow-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-yellow-600 transition duration-300">
                        <i class="fas fa-map-marker-alt mr-2"></i>Share Location
                    </button>
                </div>
                
                <button onclick="closeModal('emergencyResponseModal')" class="w-full mt-4 bg-gray-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-gray-700 transition duration-300">
                    Close (Emergency Active)
                </button>
            </div>
        </div>
    </div>

    <!-- Tourist Registration Modal -->
    <div id="registrationModal" class="modal">
        <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="text-center mb-6">
                <i class="fas fa-id-card text-4xl text-blue-600 mb-4"></i>
                <h2 class="text-2xl font-bold text-gray-900">SafeTour v2.0 Registration</h2>
                <p class="text-gray-600">Generate your Advanced Digital Tourist ID with QR Code</p>
            </div>
            <form id="registrationForm" class="space-y-4">
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                        <input type="text" id="fullName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="John Doe" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nationality</label>
                        <select id="nationality" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                            <option value="">Select Country</option>
                            <option value="IN">India</option>
                            <option value="US">United States</option>
                            <option value="UK">United Kingdom</option>
                            <option value="CA">Canada</option>
                            <option value="AU">Australia</option>
                        </select>
                    </div>
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ID Type</label>
                        <select id="idType" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                            <option value="">Select ID Type</option>
                            <option value="passport">Passport</option>
                            <option value="aadhaar">Aadhaar Card</option>
                            <option value="license">Driver's License</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ID Number</label>
                        <input type="text" id="idNumber" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Enter ID number" required>
                    </div>
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                        <input type="tel" id="phoneNumber" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="+91 9876543210" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Emergency Contact</label>
                        <input type="tel" id="emergencyContact" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="+91 9876543210" required>
                    </div>
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Visit Duration</label>
                        <select id="visitDuration" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" required>
                            <option value="">Select Duration</option>
                            <option value="1-3days">1-3 days</option>
                            <option value="4-7days">4-7 days</option>
                            <option value="1-2weeks">1-2 weeks</option>
                            <option value="1month+">1 month+</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Age</label>
                        <input type="number" id="age" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="25" min="1" max="120" required>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Planned Destinations</label>
                    <textarea id="destinations" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" rows="3" placeholder="List your planned destinations and activities..." required></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Hotel/Accommodation</label>
                    <input type="text" id="accommodation" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="Hotel name and address" required>
                </div>
                <div class="flex gap-4">
                    <button type="button" onclick="closeModal('registrationModal')" class="flex-1 bg-gray-300 text-gray-700 py-3 px-6 rounded-lg font-semibold hover:bg-gray-400 transition duration-300">
                        Cancel
                    </button>
                    <button type="submit" class="flex-1 bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition duration-300">
                        Generate v2.0 Digital ID + QR
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Quick QR Generator Modal -->
    <div id="quickQRModal" class="modal">
        <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-md w-full mx-4">
            <div class="text-center mb-6">
                <i class="fas fa-qrcode text-4xl text-green-600 mb-4"></i>
                <h2 class="text-2xl font-bold text-gray-900">Quick QR Generator</h2>
                <p class="text-gray-600">Generate QR codes for any text or data</p>
            </div>
            
            <div class="space-y-4 mb-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">QR Code Type</label>
                    <select id="qrType" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" onchange="updateQRInputs()">
                        <option value="text">Plain Text</option>
                        <option value="url">Website URL</option>
                        <option value="email">Email Address</option>
                        <option value="phone">Phone Number</option>
                        <option value="wifi">WiFi Network</option>
                        <option value="contact">Contact Card</option>
                        <option value="location">GPS Location</option>
                    </select>
                </div>
                
                <div id="qrInputContainer">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Enter Text</label>
                    <textarea id="qrTextInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" rows="3" placeholder="Enter your text here..."></textarea>
                </div>
                
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Size</label>
                        <select id="qrSize" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                            <option value="200">Small (200px)</option>
                            <option value="300" selected>Medium (300px)</option>
                            <option value="400">Large (400px)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Error Correction</label>
                        <select id="qrErrorLevel" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                            <option value="L">Low (7%)</option>
                            <option value="M" selected>Medium (15%)</option>
                            <option value="Q">Quartile (25%)</option>
                            <option value="H">High (30%)</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="flex gap-3 mb-6">
                <button onclick="generateQuickQR()" class="flex-1 bg-green-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-700 transition duration-300">
                    <i class="fas fa-magic mr-2"></i>Generate QR
                </button>
                <button onclick="closeModal('quickQRModal')" class="flex-1 bg-gray-300 text-gray-700 py-3 px-6 rounded-lg font-semibold hover:bg-gray-400 transition duration-300">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- QR Code Display Modal -->
    <div id="qrModal" class="modal">
        <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="text-center">
                <i class="fas fa-qrcode text-4xl text-blue-600 mb-4"></i>
                <h2 class="text-2xl font-bold text-gray-900 mb-4" id="qrModalTitle">SafeTour v2.0 Digital ID</h2>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- QR Code Section -->
                    <div class="bg-gray-50 p-6 rounded-xl">
                        <div id="qrCodeContainer" class="flex justify-center mb-4">
                            <canvas id="qrCanvas" class="border-2 border-gray-200 rounded-lg"></canvas>
                        </div>
                        <div class="text-center">
                            <p class="text-lg font-semibold text-blue-600 mb-2" id="displayTouristId"></p>
                            <p class="text-xs text-gray-500" id="qrDescription">Scan to view tourist information</p>
                        </div>
                    </div>
                    
                    <!-- Tourist Information Section -->
                    <div class="qr-info-card p-6 rounded-xl" id="touristInfoSection">
                        <h3 class="text-lg font-semibold text-blue-800 mb-4">
                            <i class="fas fa-user-circle mr-2"></i>Tourist Information
                        </h3>
                        <div id="touristInfoContent" class="space-y-3 text-sm">
                            <!-- Tourist info will be populated here -->
                        </div>
                    </div>
                </div>
                
                <div class="bg-blue-50 p-4 rounded-lg mt-6 text-left" id="qrFeatures">
                    <h4 class="font-semibold text-blue-900 mb-2">v2.0 Enhanced Features:</h4>
                    <ul class="text-sm text-blue-800 space-y-1">
                        <li>• Emergency SOS Integration</li>
                        <li>• Real-time Location Tracking</li>
                        <li>• Multi-channel Alert System</li>
                        <li>• Advanced Safety Scoring</li>
                        <li>• Biometric Verification Ready</li>
                        <li>• Blockchain Security Layer</li>
                    </ul>
                </div>
                
                <div class="flex gap-3 mt-6">
                    <button onclick="downloadQR()" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-300">
                        <i class="fas fa-download mr-2"></i>Download
                    </button>
                    <button onclick="shareQR()" class="flex-1 bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition duration-300">
                        <i class="fas fa-share mr-2"></i>Share
                    </button>
                    <button onclick="printQR()" class="flex-1 bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition duration-300">
                        <i class="fas fa-print mr-2"></i>Print
                    </button>
                    <button onclick="closeModal('qrModal')" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition duration-300">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- QR Scanner Modal -->
    <div id="qrScannerModal" class="modal">
        <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-lg w-full mx-4">
            <div class="text-center mb-6">
                <i class="fas fa-camera text-4xl text-purple-600 mb-4"></i>
                <h2 class="text-2xl font-bold text-gray-900">QR Code Scanner</h2>
                <p class="text-gray-600">Scan a SafeTour QR code to view tourist information</p>
            </div>
            
            <div class="bg-gray-100 p-6 rounded-xl mb-6 text-center">
                <i class="fas fa-qrcode text-6xl text-gray-400 mb-4"></i>
                <p class="text-gray-600 mb-4">Camera scanner would appear here</p>
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                    <p class="text-sm text-yellow-800">
                        <i class="fas fa-info-circle mr-2"></i>
                        Demo Mode: Use the text input below to simulate scanning
                    </p>
                </div>
                <textarea id="qrScanInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500" rows="4" placeholder="Paste QR code data here to simulate scanning..."></textarea>
            </div>
            
            <div class="flex gap-3">
                <button onclick="simulateQRScan()" class="flex-1 bg-purple-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-purple-700 transition duration-300">
                    <i class="fas fa-search mr-2"></i>Process QR Data
                </button>
                <button onclick="closeModal('qrScannerModal')" class="flex-1 bg-gray-300 text-gray-700 py-3 px-6 rounded-lg font-semibold hover:bg-gray-400 transition duration-300">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Scanned Tourist Info Modal -->
    <div id="scannedInfoModal" class="modal">
        <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-lg w-full mx-4">
            <div class="text-center mb-6">
                <i class="fas fa-user-check text-4xl text-green-600 mb-4"></i>
                <h2 class="text-2xl font-bold text-gray-900">Tourist Information</h2>
                <p class="text-gray-600">Scanned from SafeTour v2.0 QR Code</p>
            </div>
            
            <div id="scannedTouristInfo" class="space-y-4">
                <!-- Scanned tourist information will be populated here -->
            </div>
            
            <div class="flex gap-3 mt-6">
                <button onclick="contactTourist()" class="flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition duration-300">
                    <i class="fas fa-phone mr-2"></i>Contact
                </button>
                <button onclick="reportConcern()" class="flex-1 bg-yellow-600 text-white py-2 px-4 rounded-lg hover:bg-yellow-700 transition duration-300">
                    <i class="fas fa-exclamation-triangle mr-2"></i>Report
                </button>
                <button onclick="closeModal('scannedInfoModal')" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition duration-300">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notifications" class="fixed top-20 right-4 z-50 space-y-2"></div>

    <!-- Navigation -->
    <nav class="bg-white shadow-lg fixed w-full top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <i class="fas fa-shield-alt text-2xl text-blue-600 mr-2"></i>
                        <span class="text-xl font-bold text-gray-800">SafeTour v2.0</span>
                        <span class="ml-2 px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full">SOS Ready</span>
                    </div>
                </div>
                <div class="flex items-center space-x-8">
                    <button onclick="showPage('home')" class="nav-link px-3 py-2 text-sm font-medium text-gray-700 active">Home</button>
                    <button onclick="showPage('tourist-app')" class="nav-link px-3 py-2 text-sm font-medium text-gray-700">Tourist App</button>
                    <button onclick="showPage('dashboard')" class="nav-link px-3 py-2 text-sm font-medium text-gray-700">Dashboard</button>
                    <button onclick="openModal('registrationModal')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300">
                        Register v2.0
                    </button>
                    <button onclick="openModal('quickQRModal')" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition duration-300">
                        <i class="fas fa-qrcode mr-2"></i>Quick QR
                    </button>
                    <button onclick="openModal('qrScannerModal')" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition duration-300">
                        <i class="fas fa-camera mr-2"></i>Scan QR
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Home Page -->
    <div id="home" class="page active">
        <!-- Hero Section -->
        <section class="gradient-bg text-white pt-24 pb-16">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center">
                    <h1 class="text-4xl md:text-6xl font-bold mb-6">
                        SafeTour v2.0
                        <span class="block text-2xl md:text-3xl text-blue-200 mt-2">Advanced Emergency Response System</span>
                    </h1>
                    <p class="text-xl md:text-2xl mb-8 max-w-3xl mx-auto">
                        Next-generation tourist safety platform with integrated SOS emergency protocols, real-time response coordination, and AI-powered threat detection
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 justify-center">
                        <button onclick="openModal('registrationModal')" class="bg-white text-blue-600 px-8 py-3 rounded-lg font-semibold hover:bg-gray-100 transition duration-300">
                            Register for v2.0
                        </button>
                        <button onclick="showPage('tourist-app')" class="border-2 border-white text-white px-8 py-3 rounded-lg font-semibold hover:bg-white hover:text-blue-600 transition duration-300">
                            Try SOS Demo
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- QR Features Section -->
        <section class="py-16 bg-gradient-to-br from-purple-50 to-blue-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold text-gray-900 mb-4">Smart QR Code System</h2>
                    <p class="text-lg text-gray-600">Instant tourist identification and emergency response</p>
                </div>
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="bg-white p-6 rounded-xl shadow-lg text-center">
                        <div class="w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-qrcode text-white text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold mb-3">Auto-Generated QR</h3>
                        <p class="text-gray-600 mb-4">Every digital ID comes with a secure QR code containing essential tourist information</p>
                        <ul class="text-sm text-gray-700 space-y-1">
                            <li>• Name & Nationality</li>
                            <li>• Emergency Contacts</li>
                            <li>• Safety Status</li>
                            <li>• Visit Duration</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg text-center">
                        <div class="w-16 h-16 bg-purple-500 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-camera text-white text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold mb-3">Quick Scan Access</h3>
                        <p class="text-gray-600 mb-4">Authorities and helpers can instantly access tourist information by scanning the QR code</p>
                        <ul class="text-sm text-gray-700 space-y-1">
                            <li>• Instant Information</li>
                            <li>• Emergency Protocols</li>
                            <li>• Contact Details</li>
                            <li>• Medical Info</li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-lg text-center">
                        <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-shield-alt text-white text-2xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold mb-3">Secure & Private</h3>
                        <p class="text-gray-600 mb-4">QR codes contain only essential information with advanced encryption and privacy protection</p>
                        <ul class="text-sm text-gray-700 space-y-1">
                            <li>• Encrypted Data</li>
                            <li>• Privacy Protected</li>
                            <li>• Secure Access</li>
                            <li>• Audit Trail</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- v2.0 Features -->
        <section class="py-16 bg-white">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold text-gray-900 mb-4">Version 2.0 Advanced Features</h2>
                    <p class="text-lg text-gray-600">Revolutionary safety technology for modern tourism</p>
                </div>
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="bg-gradient-to-br from-red-50 to-red-100 p-6 rounded-xl">
                        <div class="w-12 h-12 bg-red-500 rounded-lg flex items-center justify-center mb-4">
                            <i class="fas fa-exclamation-triangle text-white text-xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold mb-3 text-red-800">Emergency SOS System</h3>
                        <ul class="text-red-700 space-y-2 text-sm">
                            <li>• 5-second countdown activation</li>
                            <li>• Multi-channel emergency alerts</li>
                            <li>• GPS location broadcasting</li>
                            <li>• Automatic response coordination</li>
                        </ul>
                    </div>
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl">
                        <div class="w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center mb-4">
                            <i class="fas fa-brain text-white text-xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold mb-3 text-blue-800">AI Threat Detection</h3>
                        <ul class="text-blue-700 space-y-2 text-sm">
                            <li>• Behavioral pattern analysis</li>
                            <li>• Predictive risk assessment</li>
                            <li>• Anomaly detection algorithms</li>
                            <li>• Proactive safety alerts</li>
                        </ul>
                    </div>
                    <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-xl">
                        <div class="w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center mb-4">
                            <i class="fas fa-satellite text-white text-xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold mb-3 text-green-800">Real-time Monitoring</h3>
                        <ul class="text-green-700 space-y-2 text-sm">
                            <li>• Satellite GPS tracking</li>
                            <li>• Geo-fence boundary alerts</li>
                            <li>• Live safety score updates</li>
                            <li>• 24/7 monitoring center</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Emergency Response Stats -->
        <section class="py-16 bg-gray-50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold text-gray-900 mb-4">Emergency Response Performance</h2>
                    <p class="text-lg text-gray-600">Real-time emergency system statistics</p>
                </div>
                <div class="grid md:grid-cols-4 gap-8 text-center">
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <div class="text-3xl font-bold text-red-600 mb-2">1.2m</div>
                        <div class="text-gray-600">Average Response Time</div>
                        <div class="text-xs text-green-600 mt-1">↓ 40% faster than v1.0</div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <div class="text-3xl font-bold text-blue-600 mb-2">99.8%</div>
                        <div class="text-gray-600">SOS Success Rate</div>
                        <div class="text-xs text-green-600 mt-1">Emergency alerts delivered</div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <div class="text-3xl font-bold text-green-600 mb-2">24/7</div>
                        <div class="text-gray-600">Monitoring Coverage</div>
                        <div class="text-xs text-green-600 mt-1">Global response network</div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <div class="text-3xl font-bold text-purple-600 mb-2">156</div>
                        <div class="text-gray-600">Response Centers</div>
                        <div class="text-xs text-green-600 mt-1">Worldwide coverage</div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Tourist App Page -->
    <div id="tourist-app" class="page pt-24">
        <section class="py-16 bg-gradient-to-br from-blue-50 to-purple-50">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h1 class="text-4xl font-bold text-gray-900 mb-4">SafeTour v2.0 Mobile App</h1>
                    <p class="text-lg text-gray-600">Advanced emergency response and safety monitoring</p>
                </div>

                <!-- Mobile App Simulator -->
                <div class="bg-gray-900 p-8 rounded-3xl shadow-2xl max-w-sm mx-auto">
                    <div class="bg-white rounded-2xl p-6 h-[600px] overflow-y-auto">
                        <!-- App Header -->
                        <div class="flex items-center justify-between mb-6">
                            <div class="flex items-center">
                                <i class="fas fa-shield-alt text-blue-600 text-xl mr-2"></i>
                                <span class="font-bold text-gray-900">SafeTour v2.0</span>
                            </div>
                            <div class="flex items-center">
                                <span class="status-indicator status-safe"></span>
                                <span class="text-xs text-gray-600">Protected</span>
                            </div>
                        </div>

                        <!-- Emergency SOS Button -->
                        <div class="text-center mb-6">
                            <button onclick="activateSOS()" class="sos-button w-32 h-32 rounded-full text-white font-bold text-lg shadow-lg mx-auto flex items-center justify-center flex-col">
                                <i class="fas fa-exclamation-triangle text-3xl mb-2"></i>
                                <span>SOS</span>
                                <span class="text-xs">Emergency</span>
                            </button>
                            <p class="text-xs text-gray-500 mt-2">Hold for 3 seconds to activate</p>
                        </div>

                        <!-- Tourist Status Card -->
                        <div class="bg-gradient-to-r from-green-400 to-blue-500 text-white p-4 rounded-xl mb-6">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm opacity-90">Safety Status</span>
                                <span class="text-xs bg-white bg-opacity-20 px-2 py-1 rounded">v2.0</span>
                            </div>
                            <div class="text-2xl font-bold mb-1" id="appSafetyScore">92/100</div>
                            <div class="text-sm opacity-90">Excellent - All systems active</div>
                        </div>

                        <!-- Quick Actions -->
                        <div class="grid grid-cols-2 gap-3 mb-6">
                            <button onclick="shareLocation()" class="bg-blue-500 text-white p-3 rounded-xl text-center hover:bg-blue-600 transition duration-300">
                                <i class="fas fa-map-marker-alt text-xl mb-1"></i>
                                <div class="text-xs">Share Location</div>
                            </button>
                            <button onclick="showDigitalID()" class="bg-indigo-500 text-white p-3 rounded-xl text-center hover:bg-indigo-600 transition duration-300">
                                <i class="fas fa-qrcode text-xl mb-1"></i>
                                <div class="text-xs">Digital ID</div>
                            </button>
                            <button onclick="contactHelp()" class="bg-purple-500 text-white p-3 rounded-xl text-center hover:bg-purple-600 transition duration-300">
                                <i class="fas fa-phone text-xl mb-1"></i>
                                <div class="text-xs">Help Center</div>
                            </button>
                            <button onclick="checkSafeZones()" class="bg-green-500 text-white p-3 rounded-xl text-center hover:bg-green-600 transition duration-300">
                                <i class="fas fa-shield-alt text-xl mb-1"></i>
                                <div class="text-xs">Safe Zones</div>
                            </button>
                        </div>

                        <!-- Current Status -->
                        <div class="bg-gray-50 p-4 rounded-xl mb-4">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm font-medium text-gray-700">Current Location</span>
                                <span class="text-xs text-green-600">GPS Active</span>
                            </div>
                            <div class="text-sm text-gray-600" id="currentLocation">Shillong Market, Meghalaya</div>
                            <div class="text-xs text-gray-500 mt-1">Last updated: Just now</div>
                        </div>

                        <!-- Emergency Contacts -->
                        <div class="bg-red-50 p-4 rounded-xl">
                            <h4 class="text-sm font-semibold text-red-800 mb-2">Emergency Contacts</h4>
                            <div class="space-y-2 text-xs">
                                <div class="flex justify-between items-center">
                                    <span class="text-red-700">Local Police</span>
                                    <button onclick="callEmergency('police')" class="text-red-600 hover:text-red-800">
                                        <i class="fas fa-phone"></i>
                                    </button>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-red-700">Medical Emergency</span>
                                    <button onclick="callEmergency('medical')" class="text-red-600 hover:text-red-800">
                                        <i class="fas fa-phone"></i>
                                    </button>
                                </div>
                                <div class="flex justify-between items-center">
                                    <span class="text-red-700">Tourism Helpline</span>
                                    <button onclick="callEmergency('tourism')" class="text-red-600 hover:text-red-800">
                                        <i class="fas fa-phone"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- App Features -->
                <div class="grid md:grid-cols-2 gap-8 mt-12">
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <h3 class="text-xl font-semibold mb-4 text-red-600">
                            <i class="fas fa-exclamation-triangle mr-2"></i>
                            Emergency Features
                        </h3>
                        <ul class="space-y-3">
                            <li class="flex items-center">
                                <i class="fas fa-check-circle text-green-500 mr-3"></i>
                                <span>5-second SOS activation</span>
                            </li>
                            <li class="flex items-center">
                                <i class="fas fa-check-circle text-green-500 mr-3"></i>
                                <span>Automatic location broadcasting</span>
                            </li>
                            <li class="flex items-center">
                                <i class="fas fa-check-circle text-green-500 mr-3"></i>
                                <span>Multi-channel alert system</span>
                            </li>
                            <li class="flex items-center">
                                <i class="fas fa-check-circle text-green-500 mr-3"></i>
                                <span>Emergency contact notification</span>
                            </li>
                        </ul>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <h3 class="text-xl font-semibold mb-4 text-blue-600">
                            <i class="fas fa-satellite mr-2"></i>
                            Monitoring Features
                        </h3>
                        <ul class="space-y-3">
                            <li class="flex items-center">
                                <i class="fas fa-check-circle text-green-500 mr-3"></i>
                                <span>Real-time GPS tracking</span>
                            </li>
                            <li class="flex items-center">
                                <i class="fas fa-check-circle text-green-500 mr-3"></i>
                                <span>AI-powered safety scoring</span>
                            </li>
                            <li class="flex items-center">
                                <i class="fas fa-check-circle text-green-500 mr-3"></i>
                                <span>Geo-fence boundary alerts</span>
                            </li>
                            <li class="flex items-center">
                                <i class="fas fa-check-circle text-green-500 mr-3"></i>
                                <span>24/7 monitoring center</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Dashboard Page -->
    <div id="dashboard" class="page pt-24">
        <section class="py-16 bg-gray-100">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center mb-8">
                    <div>
                        <h1 class="text-4xl font-bold text-gray-900 mb-4">SafeTour v2.0 Command Center</h1>
                        <p class="text-lg text-gray-600">Advanced emergency response and tourist monitoring</p>
                    </div>
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center">
                            <span class="status-indicator status-safe"></span>
                            <span class="text-sm text-gray-600">All Systems Operational</span>
                        </div>
                        <button onclick="refreshDashboard()" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300">
                            <i class="fas fa-sync-alt mr-2"></i>Refresh
                        </button>
                    </div>
                </div>

                <!-- Emergency Response Stats -->
                <div class="grid md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-600">Active Emergencies</p>
                                <p class="text-2xl font-bold text-red-600" id="activeEmergencies">0</p>
                                <p class="text-xs text-green-600 mt-1">All resolved</p>
                            </div>
                            <i class="fas fa-exclamation-triangle text-red-600 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-600">Response Time</p>
                                <p class="text-2xl font-bold text-blue-600" id="avgResponseTime">1.2m</p>
                                <p class="text-xs text-green-600 mt-1">↓ 40% improved</p>
                            </div>
                            <i class="fas fa-clock text-blue-600 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-600">Monitored Tourists</p>
                                <p class="text-2xl font-bold text-green-600" id="monitoredTourists">1,847</p>
                                <p class="text-xs text-green-600 mt-1">↑ 15% today</p>
                            </div>
                            <i class="fas fa-users text-green-600 text-2xl"></i>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm text-gray-600">Success Rate</p>
                                <p class="text-2xl font-bold text-purple-600" id="successRate">99.8%</p>
                                <p class="text-xs text-green-600 mt-1">Emergency resolution</p>
                            </div>
                            <i class="fas fa-check-circle text-purple-600 text-2xl"></i>
                        </div>
                    </div>
                </div>

                <!-- Recent Emergency Alerts -->
                <div class="bg-white rounded-xl shadow-sm p-6 mb-8">
                    <h3 class="text-xl font-semibold mb-4">Recent Emergency Activity</h3>
                    <div class="space-y-4" id="emergencyLog">
                        <div class="flex items-center p-4 bg-green-50 rounded-lg border-l-4 border-green-500">
                            <i class="fas fa-check-circle text-green-600 mr-4"></i>
                            <div class="flex-1">
                                <p class="font-medium">Emergency #EMG2024001 - Resolved</p>
                                <p class="text-sm text-gray-600">Tourist assistance provided - Response time: 1.1 minutes</p>
                                <p class="text-xs text-gray-500">2 hours ago</p>
                            </div>
                        </div>
                        <div class="flex items-center p-4 bg-blue-50 rounded-lg border-l-4 border-blue-500">
                            <i class="fas fa-info-circle text-blue-600 mr-4"></i>
                            <div class="flex-1">
                                <p class="font-medium">System Update - v2.0.1 Deployed</p>
                                <p class="text-sm text-gray-600">Enhanced SOS response protocols activated</p>
                                <p class="text-xs text-gray-500">6 hours ago</p>
                            </div>
                        </div>
                        <div class="flex items-center p-4 bg-yellow-50 rounded-lg border-l-4 border-yellow-500">
                            <i class="fas fa-exclamation-triangle text-yellow-600 mr-4"></i>
                            <div class="flex-1">
                                <p class="font-medium">Weather Alert - Heavy Rain Warning</p>
                                <p class="text-sm text-gray-600">Tourists in Cherrapunji area notified</p>
                                <p class="text-xs text-gray-500">8 hours ago</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
        // Application State
        let currentTouristData = null;
        let sosActive = false;
        let sosCountdownTimer = null;
        let emergencyId = null;

        // Navigation Functions
        function showPage(pageId) {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));
            
            document.getElementById(pageId).classList.add('active');
            
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => link.classList.remove('active'));
            event.target.classList.add('active');
            
            window.scrollTo(0, 0);
        }

        // Modal Functions
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Generate unique tourist ID
        function generateTouristId() {
            const timestamp = Date.now();
            const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
            return `TID${timestamp}${random}`;
        }

        // Generate verification hash
        function generateVerificationHash(data) {
            let hash = 0;
            const str = JSON.stringify(data);
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return Math.abs(hash).toString(16).toUpperCase().padStart(8, '0');
        }

        // Create scannable tourist info (public data only)
        function createScannableTouristInfo(touristData) {
            return {
                touristId: touristData.touristId,
                fullName: touristData.fullName,
                nationality: touristData.nationality,
                age: touristData.age,
                phoneNumber: touristData.phoneNumber,
                emergencyContact: touristData.emergencyContact,
                visitDuration: touristData.visitDuration,
                accommodation: touristData.accommodation,
                safetyScore: touristData.safetyScore,
                status: touristData.status,
                registrationDate: touristData.registrationDate,
                expiryDate: touristData.expiryDate,
                platform: touristData.platform,
                version: touristData.version,
                verificationHash: touristData.verificationHash,
                // Emergency info for authorities
                emergencyProtocols: {
                    sosEnabled: touristData.emergencyProtocols.sosEnabled,
                    responseTime: touristData.emergencyProtocols.responseTime
                }
            };
        }

        // Display tourist information in modal
        function displayTouristInfo(touristData) {
            const infoContent = document.getElementById('touristInfoContent');
            const nationalityNames = {
                'IN': 'India',
                'US': 'United States',
                'UK': 'United Kingdom',
                'CA': 'Canada',
                'AU': 'Australia'
            };
            
            infoContent.innerHTML = `
                <div class="space-y-3">
                    <div class="flex justify-between">
                        <span class="font-medium text-gray-700">Name:</span>
                        <span class="text-gray-900">${touristData.fullName}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-medium text-gray-700">Nationality:</span>
                        <span class="text-gray-900">${nationalityNames[touristData.nationality] || touristData.nationality}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-medium text-gray-700">Age:</span>
                        <span class="text-gray-900">${touristData.age} years</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-medium text-gray-700">Phone:</span>
                        <span class="text-gray-900">${touristData.phoneNumber}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-medium text-gray-700">Emergency Contact:</span>
                        <span class="text-gray-900">${touristData.emergencyContact}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-medium text-gray-700">Visit Duration:</span>
                        <span class="text-gray-900">${touristData.visitDuration}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-medium text-gray-700">Accommodation:</span>
                        <span class="text-gray-900 text-right text-xs">${touristData.accommodation}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-medium text-gray-700">Safety Score:</span>
                        <span class="text-green-600 font-semibold">${touristData.safetyScore}/100</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-medium text-gray-700">Status:</span>
                        <span class="text-green-600 font-semibold">${touristData.status}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-medium text-gray-700">Registration:</span>
                        <span class="text-gray-900 text-xs">${new Date(touristData.registrationDate).toLocaleDateString()}</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-medium text-gray-700">Valid Until:</span>
                        <span class="text-gray-900 text-xs">${new Date(touristData.expiryDate).toLocaleDateString()}</span>
                    </div>
                </div>
            `;
        }

        // Registration Form Handler
        document.getElementById('registrationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = {
                fullName: document.getElementById('fullName').value,
                nationality: document.getElementById('nationality').value,
                idType: document.getElementById('idType').value,
                idNumber: document.getElementById('idNumber').value,
                phoneNumber: document.getElementById('phoneNumber').value,
                emergencyContact: document.getElementById('emergencyContact').value,
                visitDuration: document.getElementById('visitDuration').value,
                age: parseInt(document.getElementById('age').value),
                destinations: document.getElementById('destinations').value,
                accommodation: document.getElementById('accommodation').value
            };

            const touristId = generateTouristId();
            
            const touristData = {
                // v2.0 Enhanced Data Structure
                touristId: touristId,
                fullName: formData.fullName,
                nationality: formData.nationality,
                age: formData.age,
                idType: formData.idType,
                idNumber: formData.idNumber,
                phoneNumber: formData.phoneNumber,
                emergencyContact: formData.emergencyContact,
                visitDuration: formData.visitDuration,
                destinations: formData.destinations,
                accommodation: formData.accommodation,
                
                // System Information
                registrationDate: new Date().toISOString(),
                registrationTimestamp: Date.now(),
                expiryDate: new Date(Date.now() + (30 * 24 * 60 * 60 * 1000)).toISOString(),
                
                // v2.0 Enhanced Safety Features
                safetyScore: Math.floor(Math.random() * 20) + 80,
                status: 'ACTIVE',
                riskLevel: 'LOW',
                emergencyProtocols: {
                    sosEnabled: true,
                    autoLocationShare: true,
                    emergencyContacts: [formData.emergencyContact],
                    responseTime: '1-3 minutes',
                    coverageArea: 'Global'
                },
                
                // AI & Monitoring
                aiMonitoring: {
                    behaviorAnalysis: true,
                    anomalyDetection: true,
                    predictiveRisk: true,
                    realTimeTracking: true
                },
                
                // Platform Information
                platform: 'SafeTour v2.0',
                version: '2.0.1',
                issuer: 'Tourism Department',
                securityLevel: 'ENHANCED',
                
                // Location & Tracking
                lastKnownLocation: {
                    latitude: null,
                    longitude: null,
                    address: 'Registration Location',
                    timestamp: new Date().toISOString(),
                    accuracy: 'GPS_HIGH'
                }
            };

            touristData.verificationHash = generateVerificationHash(touristData);
            currentTouristData = touristData;
            
            // Generate QR code with scannable info
            const scannableInfo = createScannableTouristInfo(touristData);
            generateTouristQRCode(scannableInfo, touristData);
            
            closeModal('registrationModal');
            openModal('qrModal');
            
            showNotification(`SafeTour v2.0 Digital ID generated: ${touristData.touristId}`, 'success');
        });

        // Generate QR Code for Tourist ID
        function generateTouristQRCode(scannableData, fullTouristData) {
            const qrDataString = JSON.stringify(scannableData);
            const canvas = document.getElementById('qrCanvas');
            
            QRCode.toCanvas(canvas, qrDataString, {
                width: 300,
                height: 300,
                color: {
                    dark: '#1f2937',
                    light: '#ffffff'
                },
                errorCorrectionLevel: 'H', // High error correction for v2.0
                margin: 2
            }, function (error) {
                if (error) {
                    console.error('QR Code generation failed:', error);
                    showNotification('Failed to generate QR code', 'error');
                } else {
                    document.getElementById('displayTouristId').textContent = fullTouristData.touristId;
                    document.getElementById('qrModalTitle').textContent = 'SafeTour v2.0 Digital ID';
                    document.getElementById('qrDescription').textContent = 'Scan to view tourist information';
                    
                    // Display tourist info in the modal
                    displayTouristInfo(fullTouristData);
                    
                    showNotification('v2.0 Digital ID with QR code generated successfully!', 'success');
                }
            });
        }

        // QR Code Generation for Quick QR
        function generateQRCode(touristData) {
            const qrDataString = JSON.stringify(touristData);
            const canvas = document.getElementById('qrCanvas');
            
            QRCode.toCanvas(canvas, qrDataString, {
                width: 250,
                height: 250,
                color: {
                    dark: '#1f2937',
                    light: '#ffffff'
                },
                errorCorrectionLevel: 'H',
                margin: 2
            }, function (error) {
                if (error) {
                    console.error('QR Code generation failed:', error);
                    showNotification('Failed to generate QR code', 'error');
                } else {
                    document.getElementById('displayTouristId').textContent = touristData.touristId;
                    document.getElementById('qrModalTitle').textContent = 'SafeTour v2.0 Digital ID';
                    document.getElementById('qrDescription').textContent = 'Advanced QR with Emergency Protocols';
                    showNotification('v2.0 QR code generated with enhanced security!', 'success');
                }
            });
        }

        // Quick QR Generator Functions
        function updateQRInputs() {
            const qrType = document.getElementById('qrType').value;
            const container = document.getElementById('qrInputContainer');
            
            let inputHTML = '';
            
            switch(qrType) {
                case 'text':
                    inputHTML = `
                        <label class="block text-sm font-medium text-gray-700 mb-2">Enter Text</label>
                        <textarea id="qrTextInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" rows="3" placeholder="Enter your text here..."></textarea>
                    `;
                    break;
                case 'url':
                    inputHTML = `
                        <label class="block text-sm font-medium text-gray-700 mb-2">Website URL</label>
                        <input type="url" id="qrTextInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="https://example.com">
                    `;
                    break;
                case 'email':
                    inputHTML = `
                        <div class="grid grid-cols-1 gap-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                                <input type="email" id="emailAddress" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="user@example.com">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Subject (Optional)</label>
                                <input type="text" id="emailSubject" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="Email subject">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Message (Optional)</label>
                                <textarea id="emailBody" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" rows="2" placeholder="Email message"></textarea>
                            </div>
                        </div>
                    `;
                    break;
                case 'phone':
                    inputHTML = `
                        <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                        <input type="tel" id="qrTextInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="+1234567890">
                    `;
                    break;
                case 'wifi':
                    inputHTML = `
                        <div class="grid grid-cols-1 gap-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Network Name (SSID)</label>
                                <input type="text" id="wifiSSID" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="MyWiFiNetwork">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                                <input type="password" id="wifiPassword" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="WiFi password">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Security Type</label>
                                <select id="wifiSecurity" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500">
                                    <option value="WPA">WPA/WPA2</option>
                                    <option value="WEP">WEP</option>
                                    <option value="nopass">Open (No Password)</option>
                                </select>
                            </div>
                        </div>
                    `;
                    break;
                case 'contact':
                    inputHTML = `
                        <div class="grid grid-cols-1 gap-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label>
                                <input type="text" id="contactName" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="John Doe">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                                <input type="tel" id="contactPhone" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="+1234567890">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                                <input type="email" id="contactEmail" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="john@example.com">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Organization</label>
                                <input type="text" id="contactOrg" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="Company Name">
                            </div>
                        </div>
                    `;
                    break;
                case 'location':
                    inputHTML = `
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Latitude</label>
                                <input type="number" id="locationLat" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="25.5941" step="any">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Longitude</label>
                                <input type="number" id="locationLng" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500" placeholder="91.8800" step="any">
                            </div>
                        </div>
                        <div class="mt-3">
                            <button onclick="getCurrentLocation()" class="w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition duration-300">
                                <i class="fas fa-map-marker-alt mr-2"></i>Use Current Location
                            </button>
                        </div>
                    `;
                    break;
            }
            
            container.innerHTML = inputHTML;
        }

        function getCurrentLocation() {
            if (navigator.geolocation) {
                showNotification('Getting your current location...', 'info');
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        document.getElementById('locationLat').value = position.coords.latitude.toFixed(6);
                        document.getElementById('locationLng').value = position.coords.longitude.toFixed(6);
                        showNotification('Location captured successfully!', 'success');
                    },
                    function(error) {
                        showNotification('Unable to get location. Please enter manually.', 'error');
                    }
                );
            } else {
                showNotification('Geolocation is not supported by this browser.', 'error');
            }
        }

        function generateQuickQR() {
            const qrType = document.getElementById('qrType').value;
            const size = parseInt(document.getElementById('qrSize').value);
            const errorLevel = document.getElementById('qrErrorLevel').value;
            
            let qrData = '';
            let qrTitle = '';
            let qrDesc = '';
            
            try {
                switch(qrType) {
                    case 'text':
                        qrData = document.getElementById('qrTextInput').value;
                        qrTitle = 'Text QR Code';
                        qrDesc = 'Plain text QR code';
                        break;
                    case 'url':
                        qrData = document.getElementById('qrTextInput').value;
                        if (!qrData.startsWith('http://') && !qrData.startsWith('https://')) {
                            qrData = 'https://' + qrData;
                        }
                        qrTitle = 'Website QR Code';
                        qrDesc = 'Scan to visit website';
                        break;
                    case 'email':
                        const email = document.getElementById('emailAddress').value;
                        const subject = document.getElementById('emailSubject').value || '';
                        const body = document.getElementById('emailBody').value || '';
                        qrData = `mailto:${email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
                        qrTitle = 'Email QR Code';
                        qrDesc = 'Scan to send email';
                        break;
                    case 'phone':
                        qrData = `tel:${document.getElementById('qrTextInput').value}`;
                        qrTitle = 'Phone QR Code';
                        qrDesc = 'Scan to call number';
                        break;
                    case 'wifi':
                        const ssid = document.getElementById('wifiSSID').value;
                        const password = document.getElementById('wifiPassword').value;
                        const security = document.getElementById('wifiSecurity').value;
                        qrData = `WIFI:T:${security};S:${ssid};P:${password};;`;
                        qrTitle = 'WiFi QR Code';
                        qrDesc = 'Scan to connect to WiFi';
                        break;
                    case 'contact':
                        const name = document.getElementById('contactName').value;
                        const phone = document.getElementById('contactPhone').value;
                        const contactEmail = document.getElementById('contactEmail').value;
                        const org = document.getElementById('contactOrg').value;
                        qrData = `BEGIN:VCARD\nVERSION:3.0\nFN:${name}\nORG:${org}\nTEL:${phone}\nEMAIL:${contactEmail}\nEND:VCARD`;
                        qrTitle = 'Contact QR Code';
                        qrDesc = 'Scan to save contact';
                        break;
                    case 'location':
                        const lat = document.getElementById('locationLat').value;
                        const lng = document.getElementById('locationLng').value;
                        qrData = `geo:${lat},${lng}`;
                        qrTitle = 'Location QR Code';
                        qrDesc = 'Scan to view location';
                        break;
                }
                
                if (!qrData.trim()) {
                    showNotification('Please enter the required information', 'error');
                    return;
                }
                
                // Generate QR Code
                const canvas = document.getElementById('qrCanvas');
                
                QRCode.toCanvas(canvas, qrData, {
                    width: size,
                    height: size,
                    color: {
                        dark: '#1f2937',
                        light: '#ffffff'
                    },
                    errorCorrectionLevel: errorLevel,
                    margin: 2
                }, function (error) {
                    if (error) {
                        console.error('QR Code generation failed:', error);
                        showNotification('Failed to generate QR code', 'error');
                    } else {
                        // Update modal content
                        document.getElementById('qrModalTitle').textContent = qrTitle;
                        document.getElementById('displayTouristId').textContent = qrData.length > 50 ? qrData.substring(0, 50) + '...' : qrData;
                        document.getElementById('qrDescription').textContent = qrDesc;
                        
                        // Hide tourist info section for quick QR
                        document.getElementById('touristInfoSection').style.display = 'none';
                        
                        // Update features section for quick QR
                        const featuresDiv = document.getElementById('qrFeatures');
                        featuresDiv.innerHTML = `
                            <h4 class="font-semibold text-blue-900 mb-2">QR Code Details:</h4>
                            <ul class="text-sm text-blue-800 space-y-1">
                                <li>• Type: ${qrType.charAt(0).toUpperCase() + qrType.slice(1)}</li>
                                <li>• Size: ${size}x${size} pixels</li>
                                <li>• Error Correction: ${errorLevel} Level</li>
                                <li>• Data Length: ${qrData.length} characters</li>
                                <li>• Generated: ${new Date().toLocaleString()}</li>
                            </ul>
                        `;
                        
                        closeModal('quickQRModal');
                        openModal('qrModal');
                        showNotification(`${qrTitle} generated successfully!`, 'success');
                    }
                });
                
            } catch (error) {
                console.error('Error generating QR code:', error);
                showNotification('Error generating QR code. Please check your input.', 'error');
            }
        }

        // QR Scanner Functions
        function simulateQRScan() {
            const qrData = document.getElementById('qrScanInput').value.trim();
            
            if (!qrData) {
                showNotification('Please paste QR code data to scan', 'error');
                return;
            }
            
            try {
                // Try to parse as JSON (SafeTour QR code)
                const scannedData = JSON.parse(qrData);
                
                // Check if it's a SafeTour QR code
                if (scannedData.touristId && scannedData.platform) {
                    displayScannedTouristInfo(scannedData);
                    closeModal('qrScannerModal');
                    openModal('scannedInfoModal');
                    showNotification('SafeTour QR code scanned successfully!', 'success');
                } else {
                    showNotification('This appears to be a regular QR code, not a SafeTour tourist ID', 'warning');
                }
            } catch (error) {
                // Not JSON, treat as regular QR data
                showNotification('This is not a SafeTour tourist ID QR code', 'warning');
            }
        }

        function displayScannedTouristInfo(touristData) {
            const container = document.getElementById('scannedTouristInfo');
            const nationalityNames = {
                'IN': 'India',
                'US': 'United States',
                'UK': 'United Kingdom',
                'CA': 'Canada',
                'AU': 'Australia'
            };
            
            container.innerHTML = `
                <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500 mb-4">
                    <div class="flex items-center mb-2">
                        <i class="fas fa-id-card text-blue-600 mr-2"></i>
                        <span class="font-semibold text-blue-800">Tourist ID: ${touristData.touristId}</span>
                    </div>
                    <p class="text-sm text-blue-700">Verified SafeTour v2.0 Digital ID</p>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <p class="text-xs text-gray-600 mb-1">Full Name</p>
                        <p class="font-semibold">${touristData.fullName}</p>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <p class="text-xs text-gray-600 mb-1">Nationality</p>
                        <p class="font-semibold">${nationalityNames[touristData.nationality] || touristData.nationality}</p>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <p class="text-xs text-gray-600 mb-1">Age</p>
                        <p class="font-semibold">${touristData.age} years</p>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <p class="text-xs text-gray-600 mb-1">Safety Score</p>
                        <p class="font-semibold text-green-600">${touristData.safetyScore}/100</p>
                    </div>
                </div>
                
                <div class="space-y-3">
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <p class="text-xs text-gray-600 mb-1">Phone Number</p>
                        <p class="font-semibold">${touristData.phoneNumber}</p>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <p class="text-xs text-gray-600 mb-1">Emergency Contact</p>
                        <p class="font-semibold">${touristData.emergencyContact}</p>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <p class="text-xs text-gray-600 mb-1">Accommodation</p>
                        <p class="font-semibold text-sm">${touristData.accommodation}</p>
                    </div>
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <p class="text-xs text-gray-600 mb-1">Visit Duration</p>
                        <p class="font-semibold">${touristData.visitDuration}</p>
                    </div>
                </div>
                
                <div class="bg-green-50 p-3 rounded-lg mt-4 border-l-4 border-green-500">
                    <div class="flex items-center">
                        <i class="fas fa-shield-alt text-green-600 mr-2"></i>
                        <span class="text-sm font-semibold text-green-800">Status: ${touristData.status}</span>
                    </div>
                    <p class="text-xs text-green-700 mt-1">
                        Registered: ${new Date(touristData.registrationDate).toLocaleDateString()}
                    </p>
                </div>
            `;
        }

        function contactTourist() {
            showNotification('Contacting tourist via registered phone number...', 'info');
        }

        function reportConcern() {
            showNotification('Reporting concern to SafeTour monitoring center...', 'warning');
        }

        // SOS Emergency System
        function activateSOS() {
            if (sosActive) return;
            
            sosActive = true;
            openModal('sosModal');
            
            let countdown = 5;
            document.getElementById('sosCountdown').textContent = countdown;
            
            sosCountdownTimer = setInterval(() => {
                countdown--;
                document.getElementById('sosCountdown').textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(sosCountdownTimer);
                    sendSOSNow();
                }
            }, 1000);
            
            showNotification('SOS Emergency activated! Countdown started...', 'warning');
        }

        function cancelSOS() {
            if (sosCountdownTimer) {
                clearInterval(sosCountdownTimer);
                sosCountdownTimer = null;
            }
            sosActive = false;
            closeModal('sosModal');
            showNotification('Emergency SOS cancelled', 'info');
        }

        function sendSOSNow() {
            if (sosCountdownTimer) {
                clearInterval(sosCountdownTimer);
                sosCountdownTimer = null;
            }
            
            // Generate emergency ID
            emergencyId = 'EMG' + Date.now();
            
            closeModal('sosModal');
            
            // Simulate emergency response
            setTimeout(() => {
                document.getElementById('emergencyId').textContent = emergencyId;
                openModal('emergencyResponseModal');
                
                // Update dashboard
                updateEmergencyStats();
                
                showNotification('EMERGENCY ALERT SENT! Response units dispatched.', 'warning');
                
                // Add to emergency log
                addEmergencyLog(emergencyId, 'SOS Alert Activated', 'Emergency response initiated');
            }, 1000);
        }

        // Emergency Functions
        function callEmergencyHotline() {
            showNotification('Connecting to emergency hotline...', 'info');
        }

        function shareEmergencyLocation() {
            showNotification('Emergency location shared with all response units', 'success');
        }

        function callEmergency(type) {
            const numbers = {
                'police': '911 - Police',
                'medical': '911 - Medical',
                'tourism': '1800-TOURISM'
            };
            showNotification(`Calling ${numbers[type]}...`, 'info');
        }

        // Tourist App Functions
        function shareLocation() {
            showNotification('Location shared with emergency contacts and monitoring center', 'success');
        }

        function showDigitalID() {
            if (!currentTouristData) {
                // Create demo data
                currentTouristData = {
                    touristId: 'TID2024001',
                    fullName: 'Demo User',
                    nationality: 'IN',
                    age: 28,
                    phoneNumber: '+91 9876543210',
                    emergencyContact: '+91 9876543211',
                    visitDuration: '1-2weeks',
                    accommodation: 'Hotel Shillong Heights, Police Bazar',
                    safetyScore: 92,
                    status: 'ACTIVE',
                    registrationDate: new Date().toISOString(),
                    expiryDate: new Date(Date.now() + (30 * 24 * 60 * 60 * 1000)).toISOString(),
                    emergencyProtocols: { sosEnabled: true },
                    platform: 'SafeTour v2.0',
                    version: '2.0.1',
                    verificationHash: 'DEMO1234'
                };
            }
            
            const scannableInfo = createScannableTouristInfo(currentTouristData);
            generateTouristQRCode(scannableInfo, currentTouristData);
            openModal('qrModal');
        }

        function contactHelp() {
            showNotification('Connecting to 24/7 SafeTour v2.0 help center...', 'info');
        }

        function checkSafeZones() {
            showNotification('Displaying nearby safe zones and emergency shelters', 'info');
        }

        // Dashboard Functions
        function refreshDashboard() {
            showNotification('Refreshing v2.0 command center data...', 'info');
            
            setTimeout(() => {
                // Update stats
                document.getElementById('monitoredTourists').textContent = (Math.floor(Math.random() * 100) + 1800).toLocaleString();
                document.getElementById('avgResponseTime').textContent = (Math.random() * 0.5 + 1.0).toFixed(1) + 'm';
                
                showNotification('Command center data updated', 'success');
            }, 1000);
        }

        function updateEmergencyStats() {
            const activeEmergencies = document.getElementById('activeEmergencies');
            if (activeEmergencies) {
                activeEmergencies.textContent = '1';
                activeEmergencies.parentElement.querySelector('.text-xs').textContent = 'Response in progress';
                activeEmergencies.parentElement.querySelector('.text-xs').className = 'text-xs text-red-600 mt-1';
            }
        }

        function addEmergencyLog(id, title, description) {
            const log = document.getElementById('emergencyLog');
            if (log) {
                const newEntry = document.createElement('div');
                newEntry.className = 'flex items-center p-4 bg-red-50 rounded-lg border-l-4 border-red-500';
                newEntry.innerHTML = `
                    <i class="fas fa-exclamation-triangle text-red-600 mr-4"></i>
                    <div class="flex-1">
                        <p class="font-medium">${title} - ${id}</p>
                        <p class="text-sm text-gray-600">${description}</p>
                        <p class="text-xs text-gray-500">Just now</p>
                    </div>
                `;
                log.insertBefore(newEntry, log.firstChild);
            }
        }

        // QR Functions
        function downloadQR() {
            const canvas = document.getElementById('qrCanvas');
            const link = document.createElement('a');
            const filename = currentTouristData ? 
                `SafeTour_v2_${currentTouristData.touristId}.png` : 
                'SafeTour_QR_Code.png';
            link.download = filename;
            link.href = canvas.toDataURL();
            link.click();
            
            showNotification('QR code downloaded successfully!', 'success');
        }

        function shareQR() {
            showNotification('Sharing QR code with enhanced security features', 'success');
        }

        function printQR() {
            const canvas = document.getElementById('qrCanvas');
            const qrTitle = document.getElementById('qrModalTitle').textContent;
            const qrData = document.getElementById('displayTouristId').textContent;
            
            // Create a new window for printing
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Print QR Code - ${qrTitle}</title>
                    <style>
                        body { 
                            font-family: Arial, sans-serif; 
                            text-align: center; 
                            padding: 20px;
                            margin: 0;
                        }
                        .qr-container { 
                            border: 2px solid #333; 
                            padding: 20px; 
                            margin: 20px auto; 
                            max-width: 400px;
                            background: white;
                        }
                        .qr-title { 
                            font-size: 24px; 
                            font-weight: bold; 
                            margin-bottom: 10px; 
                        }
                        .qr-data { 
                            font-size: 12px; 
                            color: #666; 
                            margin-bottom: 20px; 
                            word-break: break-all;
                        }
                        .qr-image { 
                            margin: 20px 0; 
                        }
                        .print-info { 
                            font-size: 10px; 
                            color: #999; 
                            margin-top: 20px; 
                        }
                        @media print {
                            body { margin: 0; }
                            .qr-container { border: 1px solid #000; }
                        }
                    </style>
                </head>
                <body>
                    <div class="qr-container">
                        <div class="qr-title">${qrTitle}</div>
                        <div class="qr-data">${qrData}</div>
                        <div class="qr-image">
                            <img src="${canvas.toDataURL()}" alt="QR Code" style="max-width: 100%;">
                        </div>
                        <div class="print-info">
                            Generated by SafeTour v2.0<br>
                            ${new Date().toLocaleString()}
                        </div>
                    </div>
                </body>
                </html>
            `);
            
            printWindow.document.close();
            
            // Wait for the image to load, then print
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 500);
            
            showNotification('QR code sent to printer!', 'success');
        }

        // Notification System
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification bg-white border-l-4 p-4 rounded-lg shadow-lg mb-2 ${
                type === 'success' ? 'border-green-500' : 
                type === 'error' ? 'border-red-500' : 
                type === 'warning' ? 'border-yellow-500' : 'border-blue-500'
            }`;
            
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas ${
                        type === 'success' ? 'fa-check-circle text-green-500' : 
                        type === 'error' ? 'fa-exclamation-circle text-red-500' : 
                        type === 'warning' ? 'fa-exclamation-triangle text-yellow-500' : 'fa-info-circle text-blue-500'
                    } mr-3"></i>
                    <span class="text-gray-800">${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-auto text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;
            
            document.getElementById('notifications').appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            // Close modals when clicking outside
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        this.classList.remove('active');
                        
                        // Reset tourist info section visibility
                        const touristInfoSection = document.getElementById('touristInfoSection');
                        if (touristInfoSection) {
                            touristInfoSection.style.display = 'block';
                        }
                    }
                });
            });
            
            // Welcome message
            setTimeout(() => {
                showNotification('Welcome to SafeTour v2.0! Advanced emergency response system with QR scanning ready.', 'success');
            }, 1000);
            
            // Simulate real-time updates
            setInterval(() => {
                const score = Math.floor(Math.random() * 10) + 90;
                const appScore = document.getElementById('appSafetyScore');
                if (appScore) {
                    appScore.textContent = `${score}/100`;
                }
            }, 30000);
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97cd40df1381a830',t:'MTc1NzQ4OTc3Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
